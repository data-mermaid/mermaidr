<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ingesting legacy data into MERMAID • mermaidr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Ingesting legacy data into MERMAID">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mermaidr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">Case Studies</li>
    <li>
      <a href="../articles/vo_baseline_monitoring.html">WCS Vibrant Oceans Baseline Coral Reef Monitoring</a>
    </li>
    <li>
      <a href="../articles/importing_fishbelt.html">Ingesting legacy data into MERMAID</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Getting Started</li>
    <li>
      <a href="../articles/new_to_r.html">Getting started with R</a>
    </li>
    <li>
      <a href="../articles/getting_help.html">Getting help with mermaidr</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Detailed Usage</li>
    <li>
      <a href="../articles/accessing_project_data.html">Accessing Project Data</a>
    </li>
    <li>
      <a href="../articles/accessing_dev_collect_data.html">Accessing data from the development version of MERMAID</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/data-mermaid/mermaidr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Ingesting legacy data into MERMAID</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/data-mermaid/mermaidr/blob/v1.1.0/vignettes/articles/importing_fishbelt.Rmd" class="external-link"><code>vignettes/articles/importing_fishbelt.Rmd</code></a></small>
      <div class="hidden name"><code>importing_fishbelt.Rmd</code></div>

    </div>

    
    
<p>Do you have a lot of existing data and are just starting to use
MERMAID? You might be wondering on how to import those data into
MERMAID. You can import (ingest) your legacy data into MERMAID by using
the mermaidr package. More info on the ingestion workflow with mermaidr
can be seen on the <a href="https://datamermaid.org/documentation/ingesting-legacy-data-using-r-studio" class="external-link">ingestion
documentation</a>.</p>
<p>Here we provide an example on how to import your fish data that uses
the <strong>fish belt method</strong> into MERMAID using mermaidr.
Please note that you need to <strong>prepare your project in the app
first</strong> before starting this process. Detail on how to set a new
project can be seen <a href="https://datamermaid.org/documentation/setting-up-a-new-project" class="external-link">here</a>.
For this example, we have already prepared a project in the MERMAID app
named <strong>MERMAID reef survey</strong>.</p>
<p>We have also prepared
<a href="https://www.youtube.com/watch?v=bgmz0vhg2QI" target="_blank" class="external-link">a
video</a> to walk you through the ingestion process. You can download
the <a href="https://github.com/data-mermaid/mermaidr/tree/master/examples/import_historical_fishbelt/fishbelt.csv" class="external-link">fishbelt</a>
and <a href="https://github.com/data-mermaid/mermaidr/tree/master/examples/import_historical_fishbelt/sites.csv" class="external-link">sites</a>
data for that example to follow along.</p>
<p>The steps for importing legacy fish belt data are:</p>
<ol style="list-style-type: decimal">
<li>Download the fish belt MERMAID template</li>
<li>Reformat your data to match the template</li>
<li>Address errors and warnings</li>
<li>Import (ingest) data to MERMAID</li>
</ol>
<div class="section level2">
<h2 id="download-the-fish-belt-mermaid-template">1. Download the fish belt MERMAID template<a class="anchor" aria-label="anchor" href="#download-the-fish-belt-mermaid-template"></a>
</h2>
<p>Before downloading the MERMAID template, make sure that you already
have the mermaidr package installed. You can install the package from
GitHub using the code below:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"data-mermaid/mermaidr"</span><span class="op">)</span></span></code></pre></div>
<p>In this example, we are going to also use the tidyverse package. The
first step is to load the packages and access your MERMAID projects by
using <code><a href="../reference/mermaid_search_my_projects.html">mermaid_search_my_projects()</a></code> with the project
name.</p>
<p>At this point, a browser window will open for you to authenticate by
logging into the MERMAID app. Once you’ve logged in, you can close the
browser and come back to R. Your login credentials will last for a day
and after it expires you will need to log in again.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://data-mermaid.github.io/mermaidr" class="external-link">mermaidr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">reef_survey</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mermaid_search_my_projects.html">mermaid_search_my_projects</a></span><span class="op">(</span><span class="st">"MERMAID reef survey"</span><span class="op">)</span></span></code></pre></div>
<p>The next step is to get the fish belt MERMAID template and options
using <code><a href="../reference/mermaid_import_get_template_and_options.html">mermaid_import_get_template_and_options()</a></code> and save it
to a file called <code>fishbelt_mermaid_template.xlsx</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fish_template_and_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mermaid_import_get_template_and_options.html">mermaid_import_get_template_and_options</a></span><span class="op">(</span></span>
<span>  <span class="va">reef_survey</span>,</span>
<span>  <span class="st">"fishbelt"</span>,</span>
<span>  <span class="st">"fishbelt_mermaid_template.xlsx"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error: Please supply a project to get data from, either via the `project` argument or by using `mermaid_set_default_project()`.</span></span></code></pre>
<p><img src="fishbelt_template.png" width="75%" title="Fish belt MERMAID template"></p>
<p>The XLSX file consists of the fish belt MERMAID template and the
options that are tailored based on your project. For example, the site
options that are accepted are all the sites that you have added in the
project through the MERMAID app.</p>
<p><img src="fishbelt_template_sites.png" width="50%" title="Site options"></p>
<pre><code><span><span class="co">## Error in fish_template_and_options[["Observer emails *"]][["choices"]] &lt;- tibble(value = "email@mermaid.org"): object 'fish_template_and_options' not found</span></span></code></pre>
<p>You can also preview the template in R:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fish_template_and_options</span><span class="op">[[</span><span class="st">"Template"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'fish_template_and_options' not found</span></span></code></pre>
<p>Or if you want to investigate the column names in R, you can use the
code below:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fish_template_and_options</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'fish_template_and_options' not found</span></span></code></pre>
<p>All column names with asterisk shows that it is mandatory. You can
leave the columns without the asterisk blank if the data is not
available.</p>
<p>Investigate all the available options for each column before
adjusting the format. For example, to look at the options for site in
R:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fish_template_and_options</span><span class="op">[[</span><span class="st">"Site *"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'fish_template_and_options' not found</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="reformat-your-data-to-match-the-template">2. Reformat your data to match the template<a class="anchor" aria-label="anchor" href="#reformat-your-data-to-match-the-template"></a>
</h2>
<p>After downloading the fish belt MERMAID template, you’re ready to
start reformatting your data. In this example, we are using a fish belt
width of 5 m for fish size 10-34 cm, and 20 m for fish size bigger than
34 cm. We also identify the fish size up to the closest cm.</p>
<p>The first step is to read in your data. We have prepared our data in
a CSV file and stored it in our project directory.</p>
<p>We read our fish belt data (stored in <code>fishbelt.csv</code> file)
and our sampling event data (stored in <code>sites.csv</code> file), and
save it to two different objects in R.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fishbelt_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"fishbelt.csv"</span><span class="op">)</span></span>
<span><span class="va">sites_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"sites.csv"</span><span class="op">)</span></span></code></pre></div>
<p>The MERMAID ingestion template requires the sample event data and the
observation data to be combined. Therefore, we need to add the
<code>sites</code> data set to fish observation data. Look at the
available columns in the <code>site</code> and <code>fishbelt</code>
data sets:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites_data</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 2 × 8</span></span>
<span><span class="co">##   SiteID Zone     Year Month   Day Reef_slope visibility current</span></span>
<span><span class="co">##    &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;  </span></span>
<span><span class="co">## 1   1208 Control  2021     3    15 slope              15 low    </span></span>
<span><span class="co">## 2   1206 Control  2021     3    15 slope              15 low</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fishbelt_data</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 10 × 8</span></span>
<span><span class="co">##    SiteID Depth Transect_length Width Transect_number `Fish species`     Size_cm</span></span>
<span><span class="co">##     &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt; &lt;chr&gt;                &lt;dbl&gt;</span></span>
<span><span class="co">##  1   1208     5               5     5               1 Parupeneus multif…      15</span></span>
<span><span class="co">##  2   1208     5               5    20               1 Acanthurus bariene      37</span></span>
<span><span class="co">##  3   1208     5               5    20               1 Platax teira            37</span></span>
<span><span class="co">##  4   1208     5               5    20               1 Bolbometopon muri…     120</span></span>
<span><span class="co">##  5   1208     5               5    20               1 Parupeneus indikus      36</span></span>
<span><span class="co">##  6   1208     5               5     5               1 Acanthurus aurant…      17</span></span>
<span><span class="co">##  7   1208     5               5    20               1 Plectorhinchus ch…      36</span></span>
<span><span class="co">##  8   1208     5               5     5               1 Zanclus cornutus        10</span></span>
<span><span class="co">##  9   1208     5               5    20               1 Variola albimargi…      36</span></span>
<span><span class="co">## 10   1208     5               5    20               1 Lutjanus sp.            36</span></span>
<span><span class="co">## # ℹ 1 more variable: Abundance &lt;dbl&gt;</span></span></code></pre>
<p>Then combine the <code>site</code> data to <code>fishbelt</code>
data, joining on the <code>SiteID</code> identifier.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fishbelt_data</span> <span class="op">&lt;-</span> <span class="va">fishbelt_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">sites_data</span>, by <span class="op">=</span> <span class="st">"SiteID"</span><span class="op">)</span></span></code></pre></div>
<p>Looking at the available data, there are still two mandatory fields
that are not yet added (Fish size bin and Observer emails) and one
mandatory field that need to be adjusted ( Fishbelt Width). We need to
look at the options allowed for these columns:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fish_template_and_options</span><span class="op">[[</span><span class="st">"Width *"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fish_template_and_options</span><span class="op">[[</span><span class="st">"Fish size bin *"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fish_template_and_options</span><span class="op">[[</span><span class="st">"Observer emails *"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'fish_template_and_options' not found</span></span></code></pre>
<p>Now that we know the available options, we are going to add them
manually using the code below:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fishbelt_data</span> <span class="op">&lt;-</span> <span class="va">fishbelt_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    `Width *` <span class="op">=</span> <span class="st">"Mixed: &gt;10 cm &amp; &lt;35 cm @ 5 m, &gt;=35 cm @ 20 m"</span>,</span>
<span>    `Fish size bin *` <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    `Observer emails *` <span class="op">=</span> <span class="st">"email@mermaid.org"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>The visibility data are not the same as the options accepted by
MERMAID:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fishbelt_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">visibility</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 1 × 1</span></span>
<span><span class="co">##   visibility</span></span>
<span><span class="co">##        &lt;dbl&gt;</span></span>
<span><span class="co">## 1         15</span></span></code></pre>
<p>Let’s check how it is formatted in template and implement the option
into our data:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fish_template_and_options</span><span class="op">[[</span><span class="st">"Visibility"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"choices"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fishbelt_data</span> <span class="op">&lt;-</span> <span class="va">fishbelt_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>visibility <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">visibility</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"&lt;1m - bad"</span>,</span>
<span>    <span class="va">visibility</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">~</span> <span class="st">"1-5m - poor"</span>,</span>
<span>    <span class="va">visibility</span> <span class="op">&gt;</span> <span class="fl">5</span> <span class="op">&amp;</span> <span class="va">visibility</span> <span class="op">&lt;=</span> <span class="fl">10</span> <span class="op">~</span> <span class="st">"5-10m"</span>,</span>
<span>    <span class="va">visibility</span> <span class="op">&gt;=</span> <span class="fl">10</span> <span class="op">~</span> <span class="st">"&gt;10m - excellent"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>You might already noticed that the column names in our dataset are
not the same with the template, and you might be wondering if it should
be the same. The answer is <strong>yes, they must have exactly the same
name</strong> but not necessarily the same order. Lets rename and
reorder the columns. First check the names in the template and in our
data:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fish_template_and_options</span><span class="op">[[</span><span class="st">"Template"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fishbelt_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "SiteID"            "Depth"             "Transect_length"  </span></span>
<span><span class="co">##  [4] "Width"             "Transect_number"   "Fish species"     </span></span>
<span><span class="co">##  [7] "Size_cm"           "Abundance"         "Zone"             </span></span>
<span><span class="co">## [10] "Year"              "Month"             "Day"              </span></span>
<span><span class="co">## [13] "Reef_slope"        "visibility"        "current"          </span></span>
<span><span class="co">## [16] "Width *"           "Fish size bin *"   "Observer emails *"</span></span></code></pre>
<p>Don’t worry if you don’t have any of <code>Sample time</code>,
<code>Transect label</code>, <code>Relative depth</code>,
<code>Tide</code>, <code>Sample unit notes</code> information, because
none of them are required. It will not prevent you from importing
(ingesting) your data into MERMAID. However, if you have those data, it
is strongly recommended to add them as well.</p>
<p>Next step is to rename and reorder the columns in one step:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fishbelt_data</span> <span class="op">&lt;-</span> <span class="va">fishbelt_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    `Site *` <span class="op">=</span> <span class="va">SiteID</span>,</span>
<span>    `Management *` <span class="op">=</span> <span class="va">Zone</span>,</span>
<span>    `Sample date: Year *` <span class="op">=</span> <span class="va">Year</span>,</span>
<span>    `Sample date: Month *` <span class="op">=</span> <span class="va">Month</span>,</span>
<span>    `Sample date: Day *` <span class="op">=</span> <span class="va">Day</span>,</span>
<span>    `Depth *` <span class="op">=</span> <span class="va">Depth</span>,</span>
<span>    `Transect number *` <span class="op">=</span> <span class="va">Transect_number</span>,</span>
<span>    `Transect length surveyed *` <span class="op">=</span> <span class="va">Transect_length</span>,</span>
<span>    <span class="va">`Width *`</span>,</span>
<span>    <span class="va">`Fish size bin *`</span>,</span>
<span>    `Reef slope` <span class="op">=</span> <span class="va">Reef_slope</span>,</span>
<span>    `Visibility` <span class="op">=</span> <span class="va">visibility</span>,</span>
<span>    `Current` <span class="op">=</span> <span class="va">current</span>,</span>
<span>    <span class="va">`Observer emails *`</span>,</span>
<span>    `Fish name *` <span class="op">=</span> <span class="va">`Fish species`</span>,</span>
<span>    `Size *` <span class="op">=</span> <span class="va">Size_cm</span>,</span>
<span>    `Count *` <span class="op">=</span> <span class="va">Abundance</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">fishbelt_data</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 10 × 17</span></span>
<span><span class="co">##    `Site *` `Management *` `Sample date: Year *` `Sample date: Month *`</span></span>
<span><span class="co">##       &lt;dbl&gt; &lt;chr&gt;                          &lt;dbl&gt;                  &lt;dbl&gt;</span></span>
<span><span class="co">##  1     1208 Control                         2021                      3</span></span>
<span><span class="co">##  2     1208 Control                         2021                      3</span></span>
<span><span class="co">##  3     1208 Control                         2021                      3</span></span>
<span><span class="co">##  4     1208 Control                         2021                      3</span></span>
<span><span class="co">##  5     1208 Control                         2021                      3</span></span>
<span><span class="co">##  6     1208 Control                         2021                      3</span></span>
<span><span class="co">##  7     1208 Control                         2021                      3</span></span>
<span><span class="co">##  8     1208 Control                         2021                      3</span></span>
<span><span class="co">##  9     1208 Control                         2021                      3</span></span>
<span><span class="co">## 10     1208 Control                         2021                      3</span></span>
<span><span class="co">## # ℹ 13 more variables: `Sample date: Day *` &lt;dbl&gt;, `Depth *` &lt;dbl&gt;,</span></span>
<span><span class="co">## #   `Transect number *` &lt;dbl&gt;, `Transect length surveyed *` &lt;dbl&gt;,</span></span>
<span><span class="co">## #   `Width *` &lt;chr&gt;, `Fish size bin *` &lt;dbl&gt;, `Reef slope` &lt;chr&gt;,</span></span>
<span><span class="co">## #   Visibility &lt;chr&gt;, Current &lt;chr&gt;, `Observer emails *` &lt;chr&gt;,</span></span>
<span><span class="co">## #   `Fish name *` &lt;chr&gt;, `Size *` &lt;dbl&gt;, `Count *` &lt;dbl&gt;</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="address-errors-and-warnings">3. Address errors and warnings<a class="anchor" aria-label="anchor" href="#address-errors-and-warnings"></a>
</h2>
<p>After reformatting our data, we’re going to clean our data using
<code><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options()</a></code> We need to check the columns
one by one to ensure the data are accepted by the MERMAID template. The
code below is to check our data that we’ve reformatted against the fish
belt template we’ve downloaded. If the data matches, then a check mark
will appear:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Site *"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Management *"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Sample date: Year *"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Sample date: Month *"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Sample date: Day *"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Depth *"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Transect number *"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Transect length surveyed *"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Width *"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Fish size bin *"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Reef slope"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Visibility"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Current"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Observer emails *"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Fish name *"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<p>There are issues in the Fish name that need to be fixed, marked by
the <code>FALSE</code> note under the match column. MERMAID also
provides the closest choice to help us with data cleaning. We need to
fix theses issues to be able to ingest our data:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fishbelt_data</span> <span class="op">&lt;-</span> <span class="va">fishbelt_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>`Fish name *` <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">`Fish name *`</span> <span class="op">==</span> <span class="st">"Parupeneus multifaskiatus"</span> <span class="op">~</span> <span class="st">"Parupeneus multifasciatus"</span>,</span>
<span>    <span class="va">`Fish name *`</span> <span class="op">==</span> <span class="st">"Parupeneus indikus"</span> <span class="op">~</span> <span class="st">"Parupeneus indicus"</span>,</span>
<span>    <span class="va">`Fish name *`</span> <span class="op">==</span> <span class="st">"Lutjanus sp."</span> <span class="op">~</span> <span class="st">"Lutjanus"</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">`Fish name *`</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>After fixing the issues, lets check again the values to makes sure we
receive a check mark to move forward with the process.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Fish name *"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<p>And finish checking the columns.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Size *"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_check_options.html">mermaid_import_check_options</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="va">fish_template_and_options</span>, <span class="st">"Count *"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in mermaid_import_check_options(fishbelt_data, fish_template_and_options, : object 'fish_template_and_options' not found</span></span></code></pre>
<p>Once we got the check marks, we have the cleaned version of our data
that is ready to be ingested. Let’s save the cleaned fishbelt data:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">fishbelt_data</span>, <span class="st">"fishbelt_clean.csv"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="import-ingest-data-to-mermaid">4. Import (ingest) data to MERMAID<a class="anchor" aria-label="anchor" href="#import-ingest-data-to-mermaid"></a>
</h2>
<p>Once we have our cleaned MERMAID formatted data, the next step is
ingesting the data. We do one “dry run” before actually ingesting to
check the data once more:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_project_data.html">mermaid_import_project_data</a></span><span class="op">(</span></span>
<span>  <span class="va">fishbelt_data</span>,</span>
<span>  <span class="va">reef_survey</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"fishbelt"</span>,</span>
<span>  dryrun <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error: Please supply a project to get data from, either via the `project` argument or by using `mermaid_set_default_project()`.</span></span></code></pre>
<p>Once we got the message <strong>Records successfully
checked!</strong>, change the <code>dryrun</code> option to
<code>FALSE</code> to start ingesting your data into MERMAID. Once you
got the message <strong>Records successfully imported! Please review in
Collect.</strong>, you can head to the <code>Collecting Page</code> in
your project in the MERMAID app and start validating and submitting each
transect.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mermaid_import_project_data.html">mermaid_import_project_data</a></span><span class="op">(</span></span>
<span>  <span class="va">fishbelt_data</span>,</span>
<span>  <span class="va">reef_survey</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"fishbelt"</span>,</span>
<span>  dryrun <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error: Please supply a project to get data from, either via the `project` argument or by using `mermaid_set_default_project()`.</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sharla Gelfand, Wildlife Conservation Society.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
